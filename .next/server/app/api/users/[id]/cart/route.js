"use strict";(()=>{var e={};e.id=107,e.ids=[107],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1501:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>y,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>w,staticGenerationAsyncStorage:()=>f});var r={};n.r(r),n.d(r,{DELETE:()=>u,GET:()=>d,POST:()=>c});var a=n(7092),i=n(5932),o=n(4147),s=n(2989);async function d(e,{params:t}){let{db:n}=await (0,s.d)(),r=t.id,a=await n.collection("carts").findOne({userId:r});if(!a)return new Response(JSON.stringify([]),{status:200,headers:{"Content-Type":"application/json"}});let i=a.cartIds;return new Response(JSON.stringify(await n.collection("produtos").find({id:{$in:i}}).toArray()),{status:200,headers:{"Content-Type":"application/json"}})}async function c(e,{params:t}){let{db:n}=await (0,s.d)(),r=t.id,a=(await e.json()).productId,i=(await n.collection("carts").findOneAndUpdate({userId:r},{$addToSet:{cartIds:a}},{upsert:!0,returnDocument:"after"})).value||await n.collection("carts").findOne({userId:r});return new Response(JSON.stringify(await n.collection("produtos").find({id:{$in:i?.cartIds||[]}}).toArray()),{status:201,headers:{"Content-Type":"application/json"}})}async function u(e,{params:t}){let{db:n}=await (0,s.d)(),r=t.id,a=(await e.json()).productId;await n.collection("carts").findOneAndUpdate({userId:r},{$pull:{cartIds:a}},{returnDocument:"after"});let i=(await n.collection("carts").findOne({userId:r})).cartIds;return new Response(JSON.stringify({message:"Produto removido com sucesso",products:await n.collection("produtos").find({id:{$in:i}}).toArray()}),{status:200,headers:{"Content-Type":"application/json"}})}let p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/users/[id]/cart/route",pathname:"/api/users/[id]/cart",filename:"route",bundlePath:"app/api/users/[id]/cart/route"},resolvedPagePath:"C:\\Users\\Adeilton\\loja\\app\\api\\users\\[id]\\cart\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:l,staticGenerationAsyncStorage:f,serverHooks:w}=p,y="/api/users/[id]/cart/route";function m(){return(0,o.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:f})}},2989:(e,t,n)=>{n.d(t,{d:()=>o});let r=require("mongodb"),a=null,i=null;async function o(){if(a&&i)return{client:a,db:i};let e=new r.MongoClient("mongodb+srv://acpstefanini:qhMvxA7AUt7jMUNa@cluster0.kza3sdu.mongodb.net",{serverApi:{version:r.ServerApiVersion.v1,strict:!0,deprecationErrors:!0}});try{await e.connect(),a=e,i=e.db()}finally{await e.close()}return await e.connect(),{client:e,db:e.db()}}},7092:(e,t,n)=>{e.exports=n(517)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[424],()=>n(1501));module.exports=r})();